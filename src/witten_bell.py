#!usr/bin/python

from __future__ import division
from corpus import *

class Witten_Bell(Corpus):
    def get_word_probability(self, ngram, word):
        # print ngram
        n = len(ngram) + 1

        c_up = self.get_ngram_count(n, ngram, word)

        c_down = self.get_ngram_count(n - 1, ngram[1:], word)

        n_plus = self.get_prefix_count(n, ngram)

        if c_down + n_plus == 0:
            p = float(1)/self.get_total_number_of_words()
            print " i am returning 0"
        elif len(ngram) == 1:
            p = float(c_up + n_plus * self.get_ngram_count(1, (), word) / self.get_total_number_of_words()) / (c_down + n_plus)
            if(float(p)==0.0):
                print "i ma also returning 0", c_up, n_plus
        else:
            # print ngram
            # print "c_up = ",c_up
            # print "c_down= ",c_down
            # print "n_plus = ",n_plus
            # print "prob = ", self.get_word_probability(ngram[1:], word)
            p = (c_up + n_plus * self.get_word_probability(ngram[1:], word)) / (c_down + n_plus)
            print "yoyolo 000                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   "
        return p

